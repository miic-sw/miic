<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>miic.core.corr_mat_processing.corr_mat_stretch &mdash; MIIC 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="MIIC 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Correlation matrix dictionary processing" href="../corr_mat_processing.html" />
    <link rel="next" title="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele" href="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele.html" />
    <link rel="prev" title="miic.core.corr_mat_processing.corr_mat_extract_trace" href="miic.core.corr_mat_processing.corr_mat_extract_trace.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele.html" title="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="miic.core.corr_mat_processing.corr_mat_extract_trace.html" title="miic.core.corr_mat_processing.corr_mat_extract_trace"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MIIC 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../core.html" >MIIC Library Reference</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../corr_mat_processing.html" accesskey="U">Correlation matrix dictionary processing</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/modules/autogen/miic.core.corr_mat_processing.corr_mat_stretch.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="miic-core-corr-mat-processing-corr-mat-stretch">
<h1>miic.core.corr_mat_processing.corr_mat_stretch<a class="headerlink" href="#miic-core-corr-mat-processing-corr-mat-stretch" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="miic.core.corr_mat_processing.corr_mat_stretch">
<code class="descname">corr_mat_stretch</code><span class="sig-paren">(</span><em>corr_mat</em>, <em>ref_trc=None</em>, <em>tw=None</em>, <em>stretch_range=0.1</em>, <em>stretch_steps=100</em>, <em>sides='both'</em>, <em>return_sim_mat=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic/core/corr_mat_processing.html#corr_mat_stretch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#miic.core.corr_mat_processing.corr_mat_stretch" title="Permalink to this definition">¶</a></dt>
<dd><p>Time stretch estimate through stretch and comparison.</p>
<p>This function estimates stretching of the time axis of traces as it can
occur if the propagation velocity changes.</p>
<p>Time stretching is estimated comparing each correlation function stored
in the <code class="docutils literal"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal"><span class="pre">stretch_steps</span></code>
stretched versions  of reference trace stored in <code class="docutils literal"><span class="pre">ref_trc</span></code>. If
<code class="docutils literal"><span class="pre">ref_trc</span></code> is <code class="docutils literal"><span class="pre">None</span></code> the mean of all traces is used.
The maximum amount of stretching may be passed in <code class="docutils literal"><span class="pre">stretch_range</span></code>. The
time axis is multiplied by exp(stretch).
The best match (stretching amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the stretching is
estimated on the whole trace.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>corr_mat</strong> (<em>dictionary</em>) &#8211; correlation matrix dictionary as produced by
<a class="reference internal" href="miic.core.macro.recombine_corr_data.html#miic.core.macro.recombine_corr_data" title="miic.core.macro.recombine_corr_data"><code class="xref py py-class docutils literal"><span class="pre">recombine_corr_data</span></code></a></li>
<li><strong>ref_trc</strong> (<code class="xref py py-class docutils literal"><span class="pre">ndarray</span></code>) &#8211; 1D array containing the reference trace to be stretched
and compared to the individual traces in <code class="docutils literal"><span class="pre">mat</span></code></li>
<li><strong>tw</strong> (list of <code class="xref py py-class docutils literal"><span class="pre">ndarray</span></code> of int) &#8211; list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</li>
<li><strong>stretch_range</strong> (<em>scalar</em>) &#8211; Maximum amount of relative stretching.
Stretching and compression is tested from <code class="docutils literal"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal"><span class="pre">stretch_range</span></code>.</li>
<li><strong>stretch_steps</strong> (<em>scalar`</em>) &#8211; Number of shifted version to be tested. The
increment will be <code class="docutils literal"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">stretch_range)</span> <span class="pre">/</span> <span class="pre">stretch_steps</span></code></li>
<li><strong>sides</strong> (<em>str</em>) &#8211; Side of the reference matrix to be used for the stretching
estimate (&#8216;both&#8217; | &#8216;left&#8217; | &#8216;right&#8217; | &#8216;single&#8217;) <code class="docutils literal"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">Dictionary</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="docutils">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt>
<dd><p class="first last">match for each row of <code class="docutils literal"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt>
<dd><p class="first last">the best match for each row of <code class="docutils literal"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt>
<dd><p class="first last">indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt>
<dd><p class="first last">change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to &#8216;stretch&#8217; and specify the content of</dt>
<dd><p class="first last">the returned &#8216;value&#8217;.</p>
</dd>
<dt><em>method</em>: It is equal to &#8216;single_ref&#8217; and specify in which &#8220;way&#8221; the</dt>
<dd><p class="first last">values have been obtained.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele.html" title="miic.core.corr_mat_processing.corr_mat_add_lat_lon_ele"
             >next</a> |</li>
        <li class="right" >
          <a href="miic.core.corr_mat_processing.corr_mat_extract_trace.html" title="miic.core.corr_mat_processing.corr_mat_extract_trace"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MIIC 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../core.html" >MIIC Library Reference</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../corr_mat_processing.html" >Correlation matrix dictionary processing</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, Eraldo Pomponi.
      Last updated on 2016-04-08T09:08:45.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>